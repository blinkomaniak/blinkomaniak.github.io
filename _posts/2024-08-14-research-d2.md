---
title: Day 14
date: 2024-08-14 05:00:00 +0200
categories: [research, setup]
tags: [research, test]     # TAG names should always be lowercase
---


# WE GOT XRDP connection instead of SSH

So, as you can see down below, we managed to get remote access through xrdp protocol to the ubuntu server.

![image](assets/images/Pasted image 20240814005419.png)
_Remote Desktop connection through Remmina application_

I have to be honest. I don't know what I did wrong when configuring xrdp! I guess it's one of those times, uh?!

Anyways, moving through, shall we configure our OPNSense router?

So, remember that we needed to configure a router? Here, take a look on the below figure, can you spot the three routers we need:

![alt text](assets/images/proposednetwork.png)

No? How about now?

![alt text](assets/images/proposednetwork-routers.png)

and, as you can see, we need to create dedicated tunnels between them.

But one step at a time! 

Let's start with the deployment of the first OPNSense Router in server 1.

#### Step 3. Deploy OPNSense Router in Server \#1 

The first idea that comes to my mind is go to the OPNSense documentation, maybe youtube tutorials, chatgpt, etc.

But, stop, we are engineers! we are methodic! 

I am capable of figuring this problem out!

First, this installation is virtual, so we need to know what `computational resources` do we need for this router. Then, we need to find some sort of `initial configuration`. Then, we move into `advanced configuration`.

This link [Hardware Sizing & Setup](https://docs.opnsense.org/manual/hardware.html) contains the minimum requirements to install a virtual local machine of OPNSense. The picture also depicts it:


![alt text](assets/images/opnsense-requirements.png)

This link [Installation](https://docs.opnsense.org/manual/install.html) contains the related to the installation process **but I don't find it that much useful since it does not contain a guide on virtualbox**.

This are Remmina config to access it (of course, I won't reveal sensible data):
![alt text](assets/images/xrdp-credentials.png)

We connect and ... 

Here we have a remote desktop connection to our remote server:

![alt text](assets/images/rs.png)

### Problem with XRDP and remote multiple sessions:

Now, for some reason, every time that I logout from my user session in the Remmina -remote-desktop- connection, the server does not accept my user password when trying to log-in again.

I spent so much time trying to solve that issue but I coulnd't. I will put some references here to quote what am I talking about:

- [xRDP - xRDP shows only black screen after authentication windows - HowToFix!](https://c-nergy.be/blog/?p=16682)
- [xRDP - Allow muktiple sessions (local and remote) for the same user - HowTo](https://c-nergy.be/blog/?p=16698)
- [xRDP - cannot read /etc/xrdp/key.pem. Permission denied error explain](https://c-nergy.be/blog/?p=13708)


### Let's continue with OPNSense Router implementation

We quickly check this opnsense documentation ([link](https://docs.opnsense.org/manual/install.html))

So, on the ladder link, opnsense documentation says we need to setup our virtual machine with the following minimum requirements:

- RAM: 4096 MB
- Processor: 1
- Storage: 50 GB
- Network: **It does not mention it**

Wait, what???

The official documentation doesn't mention anything about network interfaces in a virtual local installation? 

You can check here too: [link](https://docs.opnsense.org/manual/virtuals.html#local-server). And, it is a little bit surprising because it leads you to think ... I mean, we are implementing a router, right? Routers connect two or more networks. Therefore, when configuring a virtual router, we design how many networks we will directly connect. But, the documentation does not mention or suggests any network-interface configuration. And, this is not a simple issue because, in virtualbox, you can choose a network interface to be _nat, bridge, only-host_ type, etc. So, it's not so simple as _just pick 2, and be this and that_.

How about if we go straight to a youtube video. This one the community documentation beat the software-maker documentation.

